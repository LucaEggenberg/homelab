policies:
  wan_allow_traefik_public_https:
    name: "WAN -> Traefik Public (HTTP/HTTPS)"
    action: "ALLOW"
    src_zone: "external"
    dst_zone: "dmz"
    dst_group: "traefik_public_vip"
    dst_ports: "web_ports"
    logging: true
    auto_allow_return: true

  wan_block_traefik_internal_https:
    name: "WAN -> Traefik Internal (BLOCK)"
    action: "BLOCK"
    src_zone: "external"
    dst_zone: "dmz"
    dst_group: "traefik_internal_vip"
    dst_ports: "web_ports"
    logging: true
    auto_allow_return: true

  kube_allow_smb_nfs:
    name: "Kube -> NAS (SMB/NFS)"
    action: "ALLOW"
    src_zone: "dmz"
    src_group: "kube_ips"
    dst_zone: "internal"
    dst_group: "nas_ip"
    dst_ports: "smb_nfs_ports"
    auto_allow_return: true

  kube_allow_haos_https:
    name: "Kube -> Home Assistant (HTTPS)"
    action: "ALLOW"
    src_zone: "dmz"
    src_group: "kube_ips"
    dst_zone: "internal"
    dst_group: "homeassistant_ip"
    dst_port: 443
    auto_allow_return: true

  kube_to_nas_nut:
    name: "Kube -> NAS (NUT)"
    action: "ALLOW"
    src_zone: "dmz"
    src_group: "kube_ips"
    dst_zone: "internal"
    dst_group: "nas_ips"
    dst_ports: "nut_port"
    auto_allow_return: true

  kube_allow_jellyfin_forward:
    name: "Kube -> Jellyfin (HTTPS)"
    action: "ALLOW"
    src_zone: "dmz"
    src_group: "kube_ips"
    dst_zone: "dmz"
    dst_group: "jellyfin_ip"
    dst_ports: "jellyfin_ports"
    auto_allow_return: true

  kube_allow_immich_forward:
    name: "Kube -> Immich (HTTPS)"
    action: "ALLOW"
    src_zone: "dmz"
    src_group: "kube_ips"
    dst_zone: "dmz"
    dst_group: "immich_ip"
    dst_port: 2283
    auto_allow_return: true

  runner_allow_haos_ssh:
    name: "Runner -> Home Assistant (SSH)"
    action: "ALLOW"
    src_zone: "internal"
    src_group: "10.10.10.6"
    dst_zone: "internal"
    dst_group: "homeassistant_ip"
    dst_port: 22
    auto_allow_return: true

  jellyfin_allow_smb_nfs:
    name: "Jellyfin -> NAS (SMB/NFS)"
    action: "ALLOW"
    src_zone: "dmz"
    src_group: "jellyfin_ip"
    dst_zone: "internal"
    dst_group: "nas_ip"
    dst_ports: "smb_nfs_ports"
    logging: true
    auto_allow_return: true

  immich_allow_smb_nfs:
    name: "Immich -> NAS (SMB/NFS)"
    action: "ALLOW"
    src_zone: "dmz"
    src_group: "immich_ip"
    dst_zone: "internal"
    dst_group: "nas_ip"
    dst_ports: "smb_nfs_ports"
    logging: true
    auto_allow_return: true