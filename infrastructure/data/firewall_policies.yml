policies:
  kube_allow_smb_nfs:
    name: "Allow Kube to NAS"
    action: "ALLOW"
    src_zone: "dmz"
    src_group: "kube_ips"
    src_ports: null
    dst_zone: "internal"
    dst_group: "nas_ips"
    dst_ports: "smb_nfs_ports"
    logging: true
    auto_allow_return: true

  kube_allow_haos_https:
    name: "Allow Kube to Homeassistant"
    action: "ALLOW"
    src_zone: "dmz"
    src_group: "kube_ips"
    src_ports: null
    dst_zone: "internal"
    dst_group: "homeassistant_ips"
    dst_ports: "homeassistant_ports"
    logging: true
    auto_allow_return: true
    
  kube_allow_nut:
    name: "Allow Kube to NAS nut"
    action: "ALLOW"
    src_zone: "dmz"
    src_group: "kube_ips"
    dst_zone: "internal"
    dst_group: "nas_ips"
    dst_ports: "nut_ports"
    auto_allow_return: true
  
  runner_allow_kube_https:
    name: "Allow github-runner to kubernetes https"
    action: "ALLOW"
    src_zone: "restricted"
    src_group: "runner_ips"
    dst_zone: "dmz"
    dst_group: "kube_ips"
    dst_ports: "https_ports"
    logging: true
    auto_allow_return: true
  
  restricted_allow_dns:
    name: "Allow DNS"
    action: "ALLOW"
    src_zone: "restricted"
    dst_zone: "gateway"
    dst_ports: "dns_ports"
    auto_allow_return: false

  restricted_allow_dhcp:
    name: "Allow DHCP"
    action: "ALLOW"
    src_zone: "restricted"
    dst_zone: "gateway"
    src_port: 68
    dst_port: 67

  restricted_allow_icmp:
    name: "Allow ICMP"
    action: "ALLOW"
    src_zone: "restricted"
    dst_zone: "gateway"
    protocol: "icmp"
    ip_version: "IPV4"

  restricted_block_gateway:
    name: "Block All Traffic"
    action: "BLOCK"
    src_zone: "restricted"
    dst_zone: "gateway"
    index: 30000
    auto_allow_return: false

  restricted_block_internal:
    name: "Block All Traffic"
    action: "BLOCK"
    src_zone: "restricted"
    dst_zone: "internal"
    index: 30000
    auto_allow_return: false
  
  restricted_block_dmz:
    name: "Block All Traffic"
    action: "BLOCK"
    src_zone: "restricted"
    dst_zone: "dmz"
    index: 30000
    auto_allow_return: false
